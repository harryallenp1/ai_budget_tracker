{"ast":null,"code":"import * as XLSX from 'xlsx';\nexport function exportToExcel(transactions, totals) {\n  // Create workbook\n  const wb = XLSX.utils.book_new();\n\n  // Sheet 1: Transactions\n  const transactionsData = [['Date', 'Vendor', 'Category', 'Amount', 'Summary', 'Raw Vendor'], ...transactions.map(t => [t.date, t.vendor, t.category, t.amount, t.summary, t.rawVendor])];\n  const ws1 = XLSX.utils.aoa_to_sheet(transactionsData);\n  XLSX.utils.book_append_sheet(wb, ws1, 'Transactions');\n\n  // Sheet 2: Category Totals\n  const grandTotal = transactions.reduce((sum, t) => sum + t.amount, 0);\n  const totalsData = [['Category', 'Total', 'Percentage'], ...totals.map(({\n    category,\n    total\n  }) => [category, total, `${(total / grandTotal * 100).toFixed(1)}%`]), [], ['Grand Total', grandTotal, '100%']];\n  const ws2 = XLSX.utils.aoa_to_sheet(totalsData);\n  XLSX.utils.book_append_sheet(wb, ws2, 'Category Totals');\n\n  // Generate filename with timestamp\n  const timestamp = new Date().toISOString().split('T')[0];\n  const filename = `expense-report-${timestamp}.xlsx`;\n\n  // Download\n  XLSX.writeFile(wb, filename);\n}","map":{"version":3,"names":["XLSX","exportToExcel","transactions","totals","wb","utils","book_new","transactionsData","map","t","date","vendor","category","amount","summary","rawVendor","ws1","aoa_to_sheet","book_append_sheet","grandTotal","reduce","sum","totalsData","total","toFixed","ws2","timestamp","Date","toISOString","split","filename","writeFile"],"sources":["/Users/harry/Desktop/AI Buget tracker/src/utils/excelExport.js"],"sourcesContent":["import * as XLSX from 'xlsx';\n\nexport function exportToExcel(transactions, totals) {\n  // Create workbook\n  const wb = XLSX.utils.book_new();\n\n  // Sheet 1: Transactions\n  const transactionsData = [\n    ['Date', 'Vendor', 'Category', 'Amount', 'Summary', 'Raw Vendor'],\n    ...transactions.map(t => [\n      t.date,\n      t.vendor,\n      t.category,\n      t.amount,\n      t.summary,\n      t.rawVendor\n    ])\n  ];\n  const ws1 = XLSX.utils.aoa_to_sheet(transactionsData);\n  XLSX.utils.book_append_sheet(wb, ws1, 'Transactions');\n\n  // Sheet 2: Category Totals\n  const grandTotal = transactions.reduce((sum, t) => sum + t.amount, 0);\n  const totalsData = [\n    ['Category', 'Total', 'Percentage'],\n    ...totals.map(({ category, total }) => [\n      category,\n      total,\n      `${((total / grandTotal) * 100).toFixed(1)}%`\n    ]),\n    [],\n    ['Grand Total', grandTotal, '100%']\n  ];\n  const ws2 = XLSX.utils.aoa_to_sheet(totalsData);\n  XLSX.utils.book_append_sheet(wb, ws2, 'Category Totals');\n\n  // Generate filename with timestamp\n  const timestamp = new Date().toISOString().split('T')[0];\n  const filename = `expense-report-${timestamp}.xlsx`;\n\n  // Download\n  XLSX.writeFile(wb, filename);\n}\n"],"mappings":"AAAA,OAAO,KAAKA,IAAI,MAAM,MAAM;AAE5B,OAAO,SAASC,aAAaA,CAACC,YAAY,EAAEC,MAAM,EAAE;EAClD;EACA,MAAMC,EAAE,GAAGJ,IAAI,CAACK,KAAK,CAACC,QAAQ,CAAC,CAAC;;EAEhC;EACA,MAAMC,gBAAgB,GAAG,CACvB,CAAC,MAAM,EAAE,QAAQ,EAAE,UAAU,EAAE,QAAQ,EAAE,SAAS,EAAE,YAAY,CAAC,EACjE,GAAGL,YAAY,CAACM,GAAG,CAACC,CAAC,IAAI,CACvBA,CAAC,CAACC,IAAI,EACND,CAAC,CAACE,MAAM,EACRF,CAAC,CAACG,QAAQ,EACVH,CAAC,CAACI,MAAM,EACRJ,CAAC,CAACK,OAAO,EACTL,CAAC,CAACM,SAAS,CACZ,CAAC,CACH;EACD,MAAMC,GAAG,GAAGhB,IAAI,CAACK,KAAK,CAACY,YAAY,CAACV,gBAAgB,CAAC;EACrDP,IAAI,CAACK,KAAK,CAACa,iBAAiB,CAACd,EAAE,EAAEY,GAAG,EAAE,cAAc,CAAC;;EAErD;EACA,MAAMG,UAAU,GAAGjB,YAAY,CAACkB,MAAM,CAAC,CAACC,GAAG,EAAEZ,CAAC,KAAKY,GAAG,GAAGZ,CAAC,CAACI,MAAM,EAAE,CAAC,CAAC;EACrE,MAAMS,UAAU,GAAG,CACjB,CAAC,UAAU,EAAE,OAAO,EAAE,YAAY,CAAC,EACnC,GAAGnB,MAAM,CAACK,GAAG,CAAC,CAAC;IAAEI,QAAQ;IAAEW;EAAM,CAAC,KAAK,CACrCX,QAAQ,EACRW,KAAK,EACL,GAAG,CAAEA,KAAK,GAAGJ,UAAU,GAAI,GAAG,EAAEK,OAAO,CAAC,CAAC,CAAC,GAAG,CAC9C,CAAC,EACF,EAAE,EACF,CAAC,aAAa,EAAEL,UAAU,EAAE,MAAM,CAAC,CACpC;EACD,MAAMM,GAAG,GAAGzB,IAAI,CAACK,KAAK,CAACY,YAAY,CAACK,UAAU,CAAC;EAC/CtB,IAAI,CAACK,KAAK,CAACa,iBAAiB,CAACd,EAAE,EAAEqB,GAAG,EAAE,iBAAiB,CAAC;;EAExD;EACA,MAAMC,SAAS,GAAG,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;EACxD,MAAMC,QAAQ,GAAG,kBAAkBJ,SAAS,OAAO;;EAEnD;EACA1B,IAAI,CAAC+B,SAAS,CAAC3B,EAAE,EAAE0B,QAAQ,CAAC;AAC9B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}